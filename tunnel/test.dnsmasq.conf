# dnsmasq configuration for tunnel testing
# forward *.test.local queries to tunnel DNS server on host
# forward everything else to upstream DNS (8.8.8.8)

# don't read /etc/resolv.conf (use explicit servers only)
no-resolv

# disable caching (queries go straight to authoritative servers)
cache-size=0

# upstream DNS server for non-test domains
server=8.8.8.8

# forward *.test.local to tunnel DNS on host
# note: host-gateway resolves to 192.168.65.254 on docker desktop
# this is the docker host IP accessible from containers
# TODO: find a way to avoid hardcoding this IP (dnsmasq doesn't resolve hostnames in server directive)
server=/test.local/192.168.65.254#9999

# enable logging for debugging
log-queries
log-facility=-
